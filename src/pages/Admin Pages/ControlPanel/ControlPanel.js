import React, { useState } from "react";
import "./controlpanel.css";
import { Icon } from "@iconify/react/dist/iconify.js";
import { useContext, useEffect } from "react";
import { Link } from "react-router-dom";
import { TeamsNamesContext } from "../../../context/TheName";
import Note from "../../../components/notenotification/Note";
import QuestionsSection from "../../../components/QuestionsSection/QuestionsSection";
import MembersReminder from "./MembersReminder";

export default function ControlPanel() {
  const [names, , , , , errorFetch, isLoading] = useContext(TeamsNamesContext);

  const [search, setSearch] = useState("");

  const [showAnswerDrop, setShowAnswerDrop] = useState(false);

  const TheChoosenName = names.filter((memebr) =>
    memebr.name.toLocaleLowerCase().includes(search.toLocaleLowerCase())
  );

  useEffect(() => {
    document.title = "Work Culture | Control-Panel";
  }, []);

  return (
    <>
      <div
        className="blur-background"
        style={{ display: showAnswerDrop ? "block" : "none" }}
      ></div>
      <div
        className={
          showAnswerDrop ? "answer-drop-down on" : "answer-drop-down off"
        }
      >
        <p>Add Question</p>
        <input
          type="text"
          name=""
          id=""
          placeholder="write questions here .."
        />
        <textarea name="" id="" placeholder="write Answer here .."></textarea>
        <div className="btns">
          <button onClick={() => setShowAnswerDrop(false)}>Cancel</button>
          <button>Send</button>
        </div>
      </div>
      <div className="contropanel-wrapper">
        <div className="members-reminder-container">
          <div className="members-container">
            <div className="members">
              <div className="members-header">
                <div className="block-1">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="28"
                    height="21"
                    viewBox="0 0 28 21"
                    fill="none"
                  >
                    <path
                      d="M23.841 12.2239C25.6189 12.2239 27.0605 10.7833 27.0605 9.0054C27.0605 7.22751 25.6189 5.78589 23.841 5.78589C22.0636 5.78589 20.6219 7.22751 20.6219 9.0054C20.622 10.7833 22.0636 12.2239 23.841 12.2239Z"
                      fill="white"
                    />
                    <path
                      d="M27.9632 15.3262C27.8198 14.4643 27.1072 13.2578 26.5679 12.7189C26.4969 12.6475 26.1794 12.631 26.0936 12.6841C25.4379 13.0874 24.6677 13.3247 23.841 13.3247C23.0153 13.3247 22.245 13.0874 21.5893 12.6841C21.5031 12.631 21.1861 12.6475 21.115 12.7189C20.9642 12.8697 20.7997 13.0704 20.6393 13.3031C21.0733 14.1202 21.4174 14.9881 21.5416 15.7354C21.6658 16.4846 21.6255 17.1939 21.4247 17.8406C22.1377 18.0985 22.9928 18.2117 23.841 18.2117C26.0534 18.2117 28.3174 17.4446 27.9632 15.3262Z"
                      fill="white"
                    />
                    <path
                      d="M13.9173 10.8658C16.7986 10.8658 19.1346 8.52982 19.1346 5.64855C19.1346 2.76816 16.7986 0.432129 13.9173 0.432129C11.0364 0.432129 8.70128 2.76816 8.70128 5.64855C8.70128 8.52982 11.0364 10.8658 13.9173 10.8658Z"
                      fill="white"
                    />
                    <path
                      d="M18.335 11.6648C18.2218 11.5521 17.7077 11.5233 17.5679 11.6098C16.5044 12.2642 15.2562 12.6473 13.9173 12.6473C12.5793 12.6473 11.3305 12.2642 10.2675 11.6098C10.1278 11.5233 9.61368 11.5521 9.50048 11.6648C8.62433 12.5401 7.4696 14.4967 7.23729 15.8915C6.66449 19.3273 10.3345 20.5677 13.9173 20.5677C17.501 20.5677 21.171 19.3273 20.5982 15.8915C20.3658 14.4967 19.2111 12.5401 18.335 11.6648Z"
                      fill="white"
                    />
                    <path
                      d="M4.15893 12.2239C5.93638 12.2239 7.37795 10.7833 7.37795 9.0054C7.37795 7.22751 5.93638 5.78589 4.15893 5.78589C2.38099 5.78589 0.939423 7.22751 0.939423 9.0054C0.939423 10.7833 2.38099 12.2239 4.15893 12.2239Z"
                      fill="white"
                    />
                    <path
                      d="M6.29421 15.7354C6.42622 14.9505 6.7987 14.0263 7.26568 13.1717C7.13552 12.9939 7.00542 12.839 6.88532 12.7189C6.81428 12.6475 6.49721 12.631 6.41107 12.6841C5.75532 13.0874 4.98504 13.3247 4.15893 13.3247C3.33271 13.3247 2.56195 13.0874 1.90674 12.6841C1.82099 12.631 1.50303 12.6475 1.432 12.7189C0.8913 13.2578 0.180636 14.4643 0.0366985 15.3262C-0.31702 17.4446 1.9466 18.2117 4.15893 18.2117C4.94846 18.2117 5.74575 18.1145 6.42622 17.8923C6.21179 17.2325 6.1664 16.5066 6.29421 15.7354Z"
                      fill="white"
                    />
                  </svg>
                  <span>Team</span>
                  <div className="search-bar-container">
                    <div className="search-bar">
                      <input
                        type="text"
                        value={search}
                        onChange={(e) => setSearch(e.target.value)}
                      />
                      <Icon icon={"codicon:search"} />
                    </div>
                  </div>
                </div>
                <div className="block-2">
                  <div className="choose-agecny-container">
                    <div className="choose-agecny">
                      <span>All Agencies</span>
                      <Icon icon={"mdi:arrow-down-drop"} />
                    </div>
                  </div>
                  <div className="btn">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="14"
                      height="14"
                      viewBox="0 0 14 14"
                      fill="none"
                    >
                      <path
                        d="M7 13C3.68629 13 1 10.3137 1 7C1 5.46329 1.57771 4.06151 2.52779 3L4.33333 1M4.33333 1H1M4.33333 1V4.33333M7 1C10.3137 1 13 3.68629 13 7C13 8.53673 12.4223 9.93847 11.4722 11L9.66667 13M9.66667 13H13M9.66667 13V9.66667"
                        stroke="white"
                        strokeWidth="1.5"
                        strokeLinecap="round"
                        strokeLinejoin="round"
                      />
                    </svg>
                  </div>
                </div>
              </div>
              <div className="members-names">
                {isLoading && <p>Loading Names</p>}
                {errorFetch && <p>{`Error : ${errorFetch}`}</p>}
                {!errorFetch && !isLoading && names.length ? (
                  <>
                    {TheChoosenName.map((member, index) => (
                      <div key={index} className="the-member">
                        <MembersReminder member={member} index={index} />
                      </div>
                    ))}
                  </>
                ) : (
                  <>
                    {!isLoading && (
                      <p
                        style={{
                          margin: "15px 0",
                          display: "flex",
                          justifyContent: "center",
                          color: "white",
                        }}
                      >
                        "there are no Names"
                      </p>
                    )}
                  </>
                )}
              </div>
            </div>
          </div>

          <div className="reminder-container">
            <div className="reminder">
              <div className="reminder-header">
                <div className="title">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="26"
                    height="24"
                    viewBox="0 0 26 24"
                    fill="none"
                  >
                    <path
                      d="M14.1457 0.541748C11.6267 0.554008 9.18291 1.40156 7.19722 2.95162C5.21154 4.50168 3.79615 6.66666 3.17281 9.10737L2.41031 7.95425C2.33813 7.83352 2.24224 7.72867 2.12843 7.64601C2.01462 7.56335 1.88525 7.50459 1.74812 7.47329C1.61098 7.44198 1.46893 7.43877 1.33052 7.46385C1.19212 7.48894 1.06023 7.54179 0.942802 7.61923C0.825377 7.69667 0.724852 7.79709 0.647289 7.91443C0.569726 8.03177 0.516732 8.16361 0.491502 8.30199C0.466273 8.44037 0.469331 8.58242 0.500492 8.71959C0.531652 8.85675 0.59027 8.98619 0.672811 9.10008L2.96448 12.573C3.12367 12.7958 3.35836 12.9531 3.62489 13.0157C3.89705 13.0697 4.17953 13.0155 4.41239 12.8647L7.8499 10.549C7.96842 10.475 8.07083 10.3779 8.15105 10.2635C8.23127 10.1491 8.28765 10.0197 8.31684 9.88307C8.34602 9.74642 8.34741 9.60529 8.32093 9.46809C8.29445 9.33089 8.24064 9.20042 8.16269 9.08445C8.08475 8.96847 7.98427 8.86937 7.86723 8.79303C7.75019 8.71669 7.61899 8.66468 7.48144 8.64009C7.34389 8.6155 7.2028 8.61884 7.06656 8.6499C6.93032 8.68097 6.80173 8.73913 6.68844 8.82092L5.12489 9.87508C5.54102 8.1859 6.42357 6.64771 7.67186 5.43598C8.92014 4.22426 10.4839 3.38781 12.1847 3.02207C13.8855 2.65633 15.6548 2.77603 17.2909 3.3675C18.9269 3.95898 20.3638 4.99841 21.4375 6.36721C22.5112 7.73601 23.1786 9.37906 23.3634 11.1089C23.5482 12.8387 23.2431 14.5857 22.4828 16.1504C21.7226 17.7152 20.5378 19.0348 19.0637 19.9586C17.5895 20.8824 15.8854 21.3732 14.1457 21.3751C12.6544 21.3711 11.1861 21.007 9.86567 20.3139C8.54522 19.6207 7.41166 18.619 6.56135 17.3938C6.4852 17.2769 6.38632 17.1765 6.2706 17.0985C6.15488 17.0205 6.02466 16.9665 5.88769 16.9398C5.75072 16.9132 5.60978 16.9143 5.47324 16.9431C5.3367 16.9719 5.20735 17.0279 5.09286 17.1077C4.97837 17.1875 4.88109 17.2895 4.80678 17.4076C4.73246 17.5257 4.68264 17.6576 4.66027 17.7953C4.6379 17.933 4.64344 18.0739 4.67655 18.2094C4.70966 18.345 4.76967 18.4725 4.85302 18.5845C6.23538 20.5773 8.22055 22.0742 10.5168 22.8552C12.813 23.6361 15.2992 23.6598 17.6099 22.9229C19.9206 22.186 21.9341 20.7273 23.3542 18.7612C24.7744 16.7951 25.5265 14.4253 25.4999 12.0001C25.5102 8.97603 24.3205 6.07138 22.192 3.9233C20.0634 1.77521 17.1697 0.559109 14.1457 0.541748Z"
                      fill="white"
                    />
                    <path
                      d="M14.0417 5.698C13.7654 5.698 13.5004 5.80774 13.3051 6.0031C13.1097 6.19845 13 6.4634 13 6.73966V12.0001C13.0044 12.2754 13.1136 12.5388 13.3052 12.7365L16.4302 15.8897C16.6263 16.0827 16.89 16.1915 17.1652 16.1928C17.4403 16.1942 17.7051 16.088 17.9031 15.897C18.0992 15.7024 18.2101 15.438 18.2112 15.1618C18.2124 14.8856 18.1038 14.6202 17.9094 14.424L15.0833 11.572V6.73966C15.0833 6.4634 14.9736 6.19845 14.7782 6.0031C14.5829 5.80774 14.3179 5.698 14.0417 5.698Z"
                      fill="white"
                    />
                  </svg>
                  <p>Reminder History </p>
                </div>
                <div className="choose-reminder-container">
                  <div className="choose-reminder">
                    <span>All</span>
                    <Icon icon={"mdi:arrow-down-drop"} />
                  </div>
                </div>
              </div>
              <div className="the-reminders">
                <Note withBorder />
              </div>
            </div>
          </div>
        </div>
        <div className="questions-container">
          <div className="questions">
            <div className="questions-header">
              <div className="title">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="23"
                  viewBox="0 0 24 23"
                  fill="none"
                >
                  <path
                    d="M12 22.5C14.2745 22.5 16.4979 21.8549 18.3891 20.6462C20.2802 19.4375 21.7542 17.7195 22.6246 15.7095C23.495 13.6995 23.7228 11.4878 23.279 9.35401C22.8353 7.22022 21.74 5.26021 20.1317 3.72183C18.5234 2.18345 16.4743 1.1358 14.2435 0.711367C12.0128 0.286929 9.70049 0.504766 7.59914 1.33733C5.49779 2.16989 3.70173 3.57979 2.4381 5.38873C1.17446 7.19767 0.5 9.32441 0.5 11.5C0.5 14.4174 1.7116 17.2153 3.86827 19.2782C4.93614 20.2996 6.20389 21.1099 7.59914 21.6627C8.99438 22.2155 10.4898 22.5 12 22.5ZM12 20.3C11.6588 20.3 11.3253 20.2032 11.0416 20.0219C10.758 19.8406 10.5369 19.5829 10.4063 19.2814C10.2757 18.9799 10.2416 18.6482 10.3081 18.3281C10.3747 18.008 10.539 17.714 10.7802 17.4833C11.0215 17.2525 11.3288 17.0954 11.6635 17.0317C11.9981 16.968 12.3449 17.0007 12.6601 17.1256C12.9753 17.2505 13.2447 17.462 13.4343 17.7333C13.6238 18.0047 13.725 18.3237 13.725 18.65C13.725 19.0876 13.5433 19.5073 13.2198 19.8167C12.8963 20.1262 12.4575 20.3 12 20.3ZM7.4 8.1934C7.38304 7.3483 7.627 6.51717 8.10135 5.804C8.5757 5.09084 9.25938 4.52731 10.0668 4.1839C10.7829 3.87802 11.5679 3.74952 12.3495 3.81027C13.1311 3.87102 13.8842 4.11906 14.5392 4.5315C15.1432 4.914 15.6442 5.42753 16.0014 6.03028C16.3587 6.63303 16.5621 7.30796 16.595 8.00012C16.628 8.69227 16.4896 9.38209 16.1911 10.0134C15.8926 10.6447 15.4424 11.1997 14.8773 11.6331C14.0847 12.2173 13.5147 13.0343 13.2546 13.9585C13.183 14.2421 12.9965 14.4868 12.7362 14.6388C12.4758 14.7909 12.1631 14.8378 11.8666 14.7692C11.5701 14.7006 11.3143 14.5222 11.1553 14.2733C10.9964 14.0243 10.9474 13.7251 11.019 13.4415C11.3934 12.0443 12.243 10.806 13.434 9.9215C13.7171 9.70491 13.9427 9.42739 14.0923 9.11156C14.2419 8.79573 14.3114 8.45054 14.295 8.10415C14.2787 7.75776 14.1769 7.41997 13.9981 7.11834C13.8193 6.81671 13.5685 6.55978 13.2661 6.3685C12.9274 6.15643 12.5375 6.03093 12.1337 6.00397C11.7298 5.97701 11.3255 6.04949 10.9592 6.2145C10.5709 6.3923 10.2447 6.67394 10.0202 7.02534C9.79574 7.37674 9.6825 7.78284 9.69425 8.1945C9.67443 8.47215 9.54533 8.73229 9.33296 8.9225C9.12059 9.11272 8.84074 9.21887 8.5498 9.21957C8.25886 9.22026 7.97846 9.11545 7.7651 8.92626C7.55173 8.73707 7.42127 8.47755 7.4 8.2V8.1934Z"
                    fill="white"
                  />
                </svg>
                <p>Questions</p>
              </div>
              <div className="arrow-and-btn">
                <div className="right-arrow-container">
                  <Link to={"/dashbord/questions"} className="right-arrow">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      viewBox="0 0 16 16"
                      fill="none"
                    >
                      <path
                        d="M14 8H2"
                        stroke="white"
                        strokeWidth="1.5"
                        strokeLinecap="round"
                        strokeLinejoin="round"
                      />
                      <path
                        d="M10 4L14 8L10 12"
                        stroke="white"
                        strokeWidth="1.5"
                        strokeLinecap="round"
                        strokeLinejoin="round"
                      />
                    </svg>
                  </Link>
                </div>
                <div
                  className="add-question-container"
                  onClick={() => setShowAnswerDrop(true)}
                >
                  <div className="add-question">
                    <p>Add Questions</p>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="17"
                      height="18"
                      viewBox="0 0 17 18"
                      fill="none"
                    >
                      <g clipPath="url(#clip0_957_2475)">
                        <path
                          d="M8.5 0.5C3.81281 0.5 0 4.31281 0 9C0 13.6872 3.81281 17.5 8.5 17.5C13.1872 17.5 17 13.6865 17 9C17 4.31348 13.1872 0.5 8.5 0.5ZM8.5 16.1832C4.5397 16.1832 1.3168 12.961 1.3168 9C1.3168 5.03903 4.5397 1.8168 8.5 1.8168C12.4603 1.8168 15.6832 5.03903 15.6832 9C15.6832 12.961 12.461 16.1832 8.5 16.1832Z"
                          fill="white"
                        />
                        <path
                          d="M11.792 8.28226H9.15842V5.64865C9.15842 5.28521 8.86411 4.99023 8.5 4.99023C8.1359 4.99023 7.84158 5.28521 7.84158 5.64865V8.28226H5.20798C4.84387 8.28226 4.54956 8.57723 4.54956 8.94068C4.54956 9.30412 4.84387 9.59909 5.20798 9.59909H7.84158V12.2327C7.84158 12.5961 8.1359 12.8911 8.5 12.8911C8.86411 12.8911 9.15842 12.5961 9.15842 12.2327V9.59909H11.792C12.1561 9.59909 12.4504 9.30412 12.4504 8.94068C12.4504 8.57723 12.1561 8.28226 11.792 8.28226Z"
                          fill="white"
                        />
                      </g>
                      <defs>
                        <clipPath id="clip0_957_2475">
                          <rect
                            width="17"
                            height="17"
                            fill="white"
                            transform="translate(0 0.5)"
                          />
                        </clipPath>
                      </defs>
                    </svg>
                  </div>
                </div>
              </div>
            </div>
            <QuestionsSection />
          </div>
        </div>
      </div>
    </>
  );
}
